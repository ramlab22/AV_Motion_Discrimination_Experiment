function [fig] = createFit_NormCDF_1_direction(coh_list, pc, direction, audInfo, save_name)
%CREATEFIT(COH_LIST,PC_AUD)
%  Create a fit.
% direction = string 'RIGHT' or "LEFT' 
%  Data for 'untitled fit 1' fit:
%      X Input : coh_list
%      Y Output: pc
%  Output:
%      fitresult : a fit object representing the fit.
%      gof : structure with goodness-of fit info.
%
%  See also FIT, CFIT, SFIT.

%  Auto-generated by MATLAB on 10-Aug-2022 10:09:38


%% Fit: 'untitled fit 1'.
[xData, yData] = prepareCurveData( coh_list, pc );

mu = mean(yData);
sigma =std(yData);
parms = [mu, sigma];

fun_1 = @(b, x)cdf('Normal', x, b(1), b(2));
fun = @(b)sum((fun_1(b,xData) - yData).^2); 
opts = optimset('MaxFunEvals',50000, 'MaxIter',10000); 
fit_par = fminsearch(fun, parms, opts);

x = 0:.01:1;
p = cdf('Normal', x, fit_par(1), fit_par(2));

%Size of scatter point absed on frequency
if strcmp(direction, "RIGHT ONLY")
    sizes = nonzeros(audInfo.cohFreq_right(2,:)');
elseif strcmp(direction, "LEFT ONLY")
    sizes = nonzeros(audInfo.cohFreq_left(2,:)');
end
% Plot fit with data.
fig = figure( 'Name', sprintf('Psychometric Function %s',direction) );
scatter(xData, yData, sizes)
hold on 
plot(x, p);
legend('% Rightward Resp. vs. Coherence', 'NormCDF', 'Location', 'NorthEast', 'Interpreter', 'none' );
% Label axes
title(sprintf('Auditory Psych. Func. %s\n%s',direction, save_name),'Interpreter','none');
xlabel( 'Coherence %', 'Interpreter', 'none' );
ylabel( '% Rightward Response', 'Interpreter', 'none' );
xlim([0 1])
ylim([0 1])
grid on


